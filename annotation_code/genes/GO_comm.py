#!/usr/bin/env python3

from gprofiler import GProfiler
import matplotlib
matplotlib.use('gtk3agg') 
import matplotlib.pyplot as plt

def functional_analysis(genes, organism):
    gp=GProfiler(return_dataframe=True)

    #returns the GO annotation for each gene that presnents one
    result=gp.profile(organism=organism, query=genes)
    return result

def genesToGo(total, annotated):
    r=total-annotated
    plotParts=[annotated, r]
    col=["darkgreen", "darkred"]
    label=[f"Annotated genes:\n{annotated}", f"Unknown genes:\n{r}"]
    expand=(0.1, 0)
    
    plt.figure(figsize=(8,6))
    plt.title(f"Annotated gene ratio in the community: {round((annotated/total)*100, 4)}%") #title with % annotated
    plt.pie(plotParts, labels=label, explode=expand, colors=col)
    plt.axis('equal')
    plt.show()


def main():
    #genList are genes in the community
    genList=['Zm00001eb436850', 'Zm00001eb435770', 'Zm00001eb435290', 'Zm00001eb437270', 'Zm00001eb437120']
    genList=['Zm00001eb358120', 'Zm00001eb236060', 'Zm00001eb115400', 'Zm00001eb139910', 'Zm00001eb261470', 'Zm00001eb407830', 'Zm00001eb167480', 'Zm00001eb246520', 'Zm00001eb193350', 'Zm00001eb222450', 'Zm00001eb327190', 'Zm00001eb084580', 'Zm00001eb345790', 'Zm00001eb144860', 'Zm00001eb176720', 'Zm00001eb047910', 'Zm00001eb225330', 'Zm00001eb358140', 'Zm00001eb186620', 'Zm00001eb081770', 'Zm00001eb299250', 'Zm00001eb314450', 'Zm00001eb169150', 'Zm00001eb413240', 'Zm00001eb256800', 'Zm00001eb240770', 'Zm00001eb165620', 'Zm00001eb374320', 'Zm00001eb074940', 'Zm00001eb200420', 'Zm00001eb037600', 'Zm00001eb117760', 'Zm00001eb202930', 'Zm00001eb109740', 'Zm00001eb142110', 'Zm00001eb336190', 'Zm00001eb104920', 'Zm00001eb185470', 'Zm00001eb103000', 'Zm00001eb166950', 'Zm00001eb042960', 'Zm00001eb289520', 'Zm00001eb415780', 'Zm00001eb355440', 'Zm00001eb241020', 'Zm00001eb302780', 'Zm00001eb395360', 'Zm00001eb372790', 'Zm00001eb277160', 'Zm00001eb278380', 'Zm00001eb369440', 'Zm00001eb345000', 'Zm00001eb198770', 'Zm00001eb201620', 'Zm00001eb366570', 'Zm00001eb145460', 'Zm00001eb061090', 'Zm00001eb026990', 'Zm00001eb056970', 'Zm00001eb125350', 'Zm00001eb111320', 'Zm00001eb182720', 'Zm00001eb359250', 'Zm00001eb215990', 'Zm00001eb433190', 'Zm00001eb061550', 'Zm00001eb086620', 'Zm00001eb172930', 'Zm00001eb281410', 'Zm00001eb179690', 'Zm00001eb282220', 'Zm00001eb296360', 'Zm00001eb330870', 'Zm00001eb191000', 'Zm00001eb108010', 'Zm00001eb172830', 'Zm00001eb238490', 'Zm00001eb231750', 'Zm00001eb095210', 'Zm00001eb386040', 'Zm00001eb166960', 'Zm00001eb058290', 'Zm00001eb240310', 'Zm00001eb026870', 'Zm00001eb227710', 'Zm00001eb396570', 'Zm00001eb035470', 'Zm00001eb265850', 'Zm00001eb388010', 'Zm00001eb309920', 'Zm00001eb111550', 'Zm00001eb360770', 'Zm00001eb019360', 'Zm00001eb394820', 'Zm00001eb303180', 'Zm00001eb081480', 'Zm00001eb252700', 'Zm00001eb113770', 'Zm00001eb148390', 'Zm00001eb267220', 'Zm00001eb355490', 'Zm00001eb312080', 'Zm00001eb148040', 'Zm00001eb180070', 'Zm00001eb253270', 'Zm00001eb117730', 'Zm00001eb418610', 'Zm00001eb113830', 'Zm00001eb083510', 'Zm00001eb330860', 'Zm00001eb418350', 'Zm00001eb021060', 'Zm00001eb420080', 'Zm00001eb376970', 'Zm00001eb109000', 'Zm00001eb325000', 'Zm00001eb062640', 'Zm00001eb319570', 'Zm00001eb029180', 'Zm00001eb369500', 'Zm00001eb248680', 'Zm00001eb124110', 'Zm00001eb355500', 'Zm00001eb340280', 'Zm00001eb420580', 'Zm00001eb416320', 'Zm00001eb201700', 'Zm00001eb126890', 'Zm00001eb121260', 'Zm00001eb140210', 'Zm00001eb069310', 'Zm00001eb119750', 'Zm00001eb378960', 'Zm00001eb061950', 'Zm00001eb130200', 'Zm00001eb245270', 'Zm00001eb057840', 'Zm00001eb417840', 'Zm00001eb087380', 'Zm00001eb242990', 'Zm00001eb233460', 'Zm00001eb401000', 'Zm00001eb171940', 'Zm00001eb139230', 'Zm00001eb084480', 'Zm00001eb111670', 'Zm00001eb112670', 'Zm00001eb084440', 'Zm00001eb203670', 'Zm00001eb233110', 'Zm00001eb291840', 'Zm00001eb322550', 'Zm00001eb426030', 'Zm00001eb226740', 'Zm00001eb389580', 'Zm00001eb310730', 'Zm00001eb231740', 'Zm00001eb119740', 'Zm00001eb240040', 'Zm00001eb201370', 'Zm00001eb190010', 'Zm00001eb269200', 'Zm00001eb247870', 'Zm00001eb126300', 'Zm00001eb158460', 'Zm00001eb182670', 'Zm00001eb255230', 'Zm00001eb353600', 'Zm00001eb020000', 'Zm00001eb020470', 'Zm00001eb023130', 'Zm00001eb104490', 'Zm00001eb075170', 'Zm00001eb345750', 'Zm00001eb326190', 'Zm00001eb395370', 'Zm00001eb016610', 'Zm00001eb205330', 'Zm00001eb256780', 'Zm00001eb244680', 'Zm00001eb168170', 'Zm00001eb247730', 'Zm00001eb035460', 'Zm00001eb256810', 'Zm00001eb052830', 'Zm00001eb409250', 'Zm00001eb268040', 'Zm00001eb036350', 'Zm00001eb382790', 'Zm00001eb013010', 'Zm00001eb386720', 'Zm00001eb074950', 'Zm00001eb316370', 'Zm00001eb424870', 'Zm00001eb153230', 'Zm00001eb183820', 'Zm00001eb040010', 'Zm00001eb416280', 'Zm00001eb422500', 'Zm00001eb221090', 'Zm00001eb314480', 'Zm00001eb429080', 'Zm00001eb369760', 'Zm00001eb220240', 'Zm00001eb153120', 'Zm00001eb304730', 'Zm00001eb417810', 'Zm00001eb274330', 'Zm00001eb260440', 'Zm00001eb152030', 'Zm00001eb005200', 'Zm00001eb203950', 'Zm00001eb330670', 'Zm00001eb095220', 'Zm00001eb395500', 'Zm00001eb355880', 'Zm00001eb242240', 'Zm00001eb127350', 'Zm00001eb353160', 'Zm00001eb318580', 'Zm00001eb325140', 'Zm00001eb053900', 'Zm00001eb040690', 'Zm00001eb401630', 'Zm00001eb005250', 'Zm00001eb113980', 'Zm00001eb011930', 'Zm00001eb344400', 'Zm00001eb085220', 'Zm00001eb377800', 'Zm00001eb053890', 'Zm00001eb326990', 'Zm00001eb037340', 'Zm00001eb225600', 'Zm00001eb265480', 'Zm00001eb418460', 'Zm00001eb196560', 'Zm00001eb316660', 'Zm00001eb000630', 'Zm00001eb267570', 'Zm00001eb238440', 'Zm00001eb023060', 'Zm00001eb224760', 'Zm00001eb108670', 'Zm00001eb173690', 'Zm00001eb014550', 'Zm00001eb337190', 'Zm00001eb391340', 'Zm00001eb302490', 'Zm00001eb027430', 'Zm00001eb240780', 'Zm00001eb313800', 'Zm00001eb311040', 'Zm00001eb272350', 'Zm00001eb240820', 'Zm00001eb042470', 'Zm00001eb269580', 'Zm00001eb178220', 'Zm00001eb045640', 'Zm00001eb109080', 'Zm00001eb373570', 'Zm00001eb295790', 'Zm00001eb355550',
              'Zm00001eb129270', 'Zm00001eb067400', 'Zm00001eb207110', 'Zm00001eb114760', 'Zm00001eb315280', 'Zm00001eb049000', 'Zm00001eb046510', 'Zm00001eb077570', 'Zm00001eb323630', 'Zm00001eb261420', 'Zm00001eb170080', 'Zm00001eb340880', 'Zm00001eb109260', 'Zm00001eb108630', 'Zm00001eb006120', 'Zm00001eb423330', 'Zm00001eb261400', 'Zm00001eb380720', 'Zm00001eb358260', 'Zm00001eb112530', 'Zm00001eb220810', 'Zm00001eb278390', 'Zm00001eb300370', 'Zm00001eb429390', 'Zm00001eb030130', 'Zm00001eb345010', 'Zm00001eb412850', 'Zm00001eb112060', 'Zm00001eb112520', 'Zm00001eb081520', 'Zm00001eb429210', 'Zm00001eb138660', 'Zm00001eb327910', 'Zm00001eb246220', 'Zm00001eb155500', 'Zm00001eb349140', 'Zm00001eb355710', 'Zm00001eb039750', 'Zm00001eb061140', 'Zm00001eb138640', 'Zm00001eb389690', 'Zm00001eb245570', 'Zm00001eb300470', 'Zm00001eb004920', 'Zm00001eb282610', 'Zm00001eb169550', 'Zm00001eb382030', 'Zm00001eb416580', 'Zm00001eb142500', 'Zm00001eb180210', 'Zm00001eb129350', 'Zm00001eb376710', 'Zm00001eb088070', 'Zm00001eb129340', 'Zm00001eb050050', 'Zm00001eb210480', 'Zm00001eb211810', 'Zm00001eb200660', 'Zm00001eb366340', 'Zm00001eb387470', 'Zm00001eb076760', 'Zm00001eb113810', 'Zm00001eb180830', 'Zm00001eb347440', 'Zm00001eb315270', 'Zm00001eb391160', 'Zm00001eb223680', 'Zm00001eb169210', 'Zm00001eb366140', 'Zm00001eb361860', 'Zm00001eb374310', 'Zm00001eb008530', 'Zm00001eb238700', 'Zm00001eb219740', 'Zm00001eb219340', 'Zm00001eb253260', 'Zm00001eb285110', 'Zm00001eb288220', 'Zm00001eb068590', 'Zm00001eb003400', 'Zm00001eb426110', 'Zm00001eb229230', 'Zm00001eb113760', 'Zm00001eb416640', 'Zm00001eb378610', 'Zm00001eb164990', 'Zm00001eb388000', 'Zm00001eb207200', 'Zm00001eb035480', 'Zm00001eb082010', 'Zm00001eb005100', 'Zm00001eb054560', 'Zm00001eb177200', 'Zm00001eb337680', 'Zm00001eb142100', 'Zm00001eb076970', 'Zm00001eb201820', 'Zm00001eb422120', 'Zm00001eb022630', 'Zm00001eb342020', 'Zm00001eb186650', 'Zm00001eb212670', 'Zm00001eb269680', 'Zm00001eb094330', 'Zm00001eb066990', 'Zm00001eb233470', 'Zm00001eb098300', 'Zm00001eb146590', 'Zm00001eb425590', 'Zm00001eb076090', 'Zm00001eb138460', 'Zm00001eb211700', 'Zm00001eb272730', 'Zm00001eb019660', 'Zm00001eb308100', 'Zm00001eb169520', 'Zm00001eb401070', 'Zm00001eb152260', 'Zm00001eb249580', 'Zm00001eb225580', 'Zm00001eb405040', 'Zm00001eb211820', 'Zm00001eb353040', 'Zm00001eb042440', 'Zm00001eb265330', 'Zm00001eb280660', 'Zm00001eb189100', 'Zm00001eb302150', 'Zm00001eb303160', 'Zm00001eb364120', 'Zm00001eb347850', 'Zm00001eb015560', 'Zm00001eb324150', 'Zm00001eb101040', 'Zm00001eb414150', 'Zm00001eb407130', 'Zm00001eb340140', 'Zm00001eb354130', 'Zm00001eb422360', 'Zm00001eb067220', 'Zm00001eb054970', 'Zm00001eb183950', 'Zm00001eb151980', 'Zm00001eb359000', 'Zm00001eb189490', 'Zm00001eb221540', 'Zm00001eb168400', 'Zm00001eb031780', 'Zm00001eb162630', 'Zm00001eb387280', 'Zm00001eb246760', 'Zm00001eb241170', 'Zm00001eb131340', 'Zm00001eb326960', 'Zm00001eb419150', 'Zm00001eb148650', 'Zm00001eb038660', 'Zm00001eb201870', 'Zm00001eb071730', 'Zm00001eb219620', 'Zm00001eb166860', 'Zm00001eb175400', 'Zm00001eb324550', 'Zm00001eb270310', 'Zm00001eb275790', 'Zm00001eb137490', 'Zm00001eb072990', 'Zm00001eb079630', 'Zm00001eb161230', 'Zm00001eb201800', 'Zm00001eb307740', 'Zm00001eb318740', 'Zm00001eb201790', 'Zm00001eb253220', 'Zm00001eb166940', 'Zm00001eb112570', 'Zm00001eb326030', 'Zm00001eb138090', 'Zm00001eb052450', 'Zm00001eb342670', 'Zm00001eb243200', 'Zm00001eb354570', 'Zm00001eb417880', 'Zm00001eb411170', 'Zm00001eb170070', 'Zm00001eb380870', 'Zm00001eb200480', 'Zm00001eb419140', 'Zm00001eb285410', 'Zm00001eb355760', 'Zm00001eb000900', 'Zm00001eb313810', 'Zm00001eb120680', 'Zm00001eb155490', 'Zm00001eb302040', 'Zm00001eb036770', 'Zm00001eb082770', 'Zm00001eb249990', 'Zm00001eb161220', 'Zm00001eb281900', 'Zm00001eb187280', 'Zm00001eb213420', 'Zm00001eb255760', 'Zm00001eb076690', 'Zm00001eb317580', 'Zm00001eb201670', 'Zm00001eb278070', 'Zm00001eb023180', 'Zm00001eb364110', 'Zm00001eb238900', 'Zm00001eb077950', 'Zm00001eb076930', 'Zm00001eb166610', 'Zm00001eb356930', 'Zm00001eb286190', 'Zm00001eb375260', 'Zm00001eb309940', 'Zm00001eb202610', 'Zm00001eb201830', 'Zm00001eb206530', 'Zm00001eb033870', 'Zm00001eb166620', 'Zm00001eb416270', 'Zm00001eb159820', 'Zm00001eb421230', 'Zm00001eb175640', 'Zm00001eb020940', 'Zm00001eb176800', 'Zm00001eb304390', 'Zm00001eb138730', 'Zm00001eb050770', 'Zm00001eb341550', 'Zm00001eb090780', 'Zm00001eb166650', 'Zm00001eb047000', 'Zm00001eb254000', 'Zm00001eb336830', 'Zm00001eb250000', 'Zm00001eb144590', 'Zm00001eb227630', 'Zm00001eb150000', 'Zm00001eb304120', 'Zm00001eb138420', 'Zm00001eb380770', 'Zm00001eb040370', 'Zm00001eb319810', 'Zm00001eb314550', 'Zm00001eb228560', 'Zm00001eb142290', 'Zm00001eb330140', 'Zm00001eb065830', 'Zm00001eb235570', 'Zm00001eb076100', 'Zm00001eb191750', 'Zm00001eb294940', 'Zm00001eb262600', 'Zm00001eb183960', 'Zm00001eb415450', 'Zm00001eb275780', 'Zm00001eb198620', 'Zm00001eb372170', 'Zm00001eb247740', 'Zm00001eb430080',
              'Zm00001eb382270', 'Zm00001eb018110', 'Zm00001eb114290', 'Zm00001eb115380', 'Zm00001eb429220', 'Zm00001eb147250', 'Zm00001eb143690', 'Zm00001eb089930', 'Zm00001eb336360', 'Zm00001eb283420', 'Zm00001eb067390', 'Zm00001eb139600', 'Zm00001eb380410', 'Zm00001eb152330', 'Zm00001eb062130', 'Zm00001eb415180', 'Zm00001eb204200', 'Zm00001eb320990', 'Zm00001eb383410', 'Zm00001eb130510', 'Zm00001eb368560', 'Zm00001eb270320', 'Zm00001eb145630', 'Zm00001eb179230', 'Zm00001eb112390', 'Zm00001eb302050', 'Zm00001eb077000', 'Zm00001eb172690', 'Zm00001eb102820', 'Zm00001eb336350', 'Zm00001eb088120', 'Zm00001eb367700', 'Zm00001eb353210', 'Zm00001eb381320', 'Zm00001eb216700', 'Zm00001eb164600', 'Zm00001eb225360', 'Zm00001eb267010', 'Zm00001eb056980', 'Zm00001eb156430', 'Zm00001eb082780', 'Zm00001eb423990', 'Zm00001eb009340', 'Zm00001eb417830', 'Zm00001eb411310', 'Zm00001eb044250', 'Zm00001eb101160', 'Zm00001eb305560', 'Zm00001eb304880', 'Zm00001eb223580', 'Zm00001eb355510', 'Zm00001eb200460', 'Zm00001eb031350', 'Zm00001eb142270', 'Zm00001eb426360', 'Zm00001eb367990', 'Zm00001eb378140', 'Zm00001eb003120', 'Zm00001eb201840', 'Zm00001eb107850', 'Zm00001eb049180', 'Zm00001eb266070', 'Zm00001eb296380', 'Zm00001eb249480', 'Zm00001eb395330', 'Zm00001eb317850', 'Zm00001eb398100', 'Zm00001eb114000', 'Zm00001eb152400', 'Zm00001eb275020', 'Zm00001eb070910', 'Zm00001eb305630', 'Zm00001eb056110', 'Zm00001eb397680', 'Zm00001eb069320', 'Zm00001eb295870', 'Zm00001eb166600', 'Zm00001eb122700', 'Zm00001eb296370', 'Zm00001eb006160', 'Zm00001eb324940', 'Zm00001eb301350', 'Zm00001eb313790', 'Zm00001eb335120', 'Zm00001eb041320', 'Zm00001eb306010', 'Zm00001eb086630', 'Zm00001eb335130', 'Zm00001eb275760', 'Zm00001eb247680', 'Zm00001eb422690', 'Zm00001eb372460', 'Zm00001eb164850', 'Zm00001eb309260', 'Zm00001eb155430', 'Zm00001eb406570', 'Zm00001eb166660', 'Zm00001eb147240', 'Zm00001eb419540', 'Zm00001eb101630', 'Zm00001eb166670', 'Zm00001eb416310', 'Zm00001eb293790', 'Zm00001eb202400', 'Zm00001eb373460', 'Zm00001eb284560', 'Zm00001eb351810', 'Zm00001eb129830', 'Zm00001eb172810', 'Zm00001eb120080', 'Zm00001eb135750', 'Zm00001eb419900', 'Zm00001eb277150', 'Zm00001eb350070', 'Zm00001eb173090', 'Zm00001eb130000', 'Zm00001eb426040', 'Zm00001eb159490', 'Zm00001eb113990', 'Zm00001eb091230', 'Zm00001eb350550', 'Zm00001eb304700', 'Zm00001eb266150', 'Zm00001eb167280', 'Zm00001eb101850', 'Zm00001eb429020', 'Zm00001eb030160', 'Zm00001eb283520', 'Zm00001eb066440', 'Zm00001eb295400', 'Zm00001eb146580', 'Zm00001eb386710', 'Zm00001eb303510', 'Zm00001eb036820', 'Zm00001eb337690', 'Zm00001eb354910', 'Zm00001eb056170', 'Zm00001eb355430', 'Zm00001eb093790', 'Zm00001eb284400', 'Zm00001eb225460', 'Zm00001eb428900', 'Zm00001eb015020', 'Zm00001eb108020', 'Zm00001eb260840', 'Zm00001eb208540', 'Zm00001eb305790', 'Zm00001eb404170', 'Zm00001eb405550', 'Zm00001eb376620', 'Zm00001eb304240', 'Zm00001eb171930', 'Zm00001eb342250', 'Zm00001eb387490', 'Zm00001eb324760', 'Zm00001eb137930', 'Zm00001eb240320', 'Zm00001eb237080', 'Zm00001eb397690', 'Zm00001eb119730', 'Zm00001eb010170', 'Zm00001eb075970', 'Zm00001eb349470', 'Zm00001eb334180', 'Zm00001eb340380', 'Zm00001eb426750', 'Zm00001eb297160', 'Zm00001eb177280', 'Zm00001eb021050', 'Zm00001eb301130', 'Zm00001eb171970', 'Zm00001eb043530', 'Zm00001eb419870', 'Zm00001eb378950', 'Zm00001eb402150', 'Zm00001eb136260', 'Zm00001eb330660', 'Zm00001eb309650', 'Zm00001eb354390', 'Zm00001eb181050', 'Zm00001eb121900', 'Zm00001eb302080', 'Zm00001eb035490', 'Zm00001eb400020', 'Zm00001eb017990', 'Zm00001eb266290', 'Zm00001eb267120', 'Zm00001eb433690', 'Zm00001eb224070', 'Zm00001eb416260', 'Zm00001eb350350', 'Zm00001eb315260', 'Zm00001eb231000', 'Zm00001eb245600', 'Zm00001eb219130', 'Zm00001eb151130', 'Zm00001eb306560', 'Zm00001eb156320', 'Zm00001eb262850', 'Zm00001eb302020', 'Zm00001eb279580', 'Zm00001eb204870', 'Zm00001eb274820', 'Zm00001eb044800', 'Zm00001eb083790', 'Zm00001eb193940', 'Zm00001eb053690', 'Zm00001eb129750', 'Zm00001eb328770', 'Zm00001eb217170', 'Zm00001eb283060', 'Zm00001eb360780', 'Zm00001eb325870', 'Zm00001eb303130', 'Zm00001eb164680', 'Zm00001eb372470', 'Zm00001eb240190', 'Zm00001eb292120', 'Zm00001eb036030', 'Zm00001eb109090', 'Zm00001eb378060', 'Zm00001eb129600', 'Zm00001eb332740', 'Zm00001eb236020', 'Zm00001eb113490', 'Zm00001eb268380', 'Zm00001eb057010', 'Zm00001eb368000', 'Zm00001eb363890', 'Zm00001eb055930', 'Zm00001eb270330', 'Zm00001eb215860', 'Zm00001eb319730', 'Zm00001eb301570', 'Zm00001eb111410', 'Zm00001eb430460', 'Zm00001eb302070', 'Zm00001eb082900', 'Zm00001eb320390', 'Zm00001eb118090', 'Zm00001eb311050', 'Zm00001eb084710', 'Zm00001eb272610', 'Zm00001eb230090', 'Zm00001eb281380', 'Zm00001eb152450', 'Zm00001eb424780', 'Zm00001eb025740', 'Zm00001eb163220', 'Zm00001eb147780', 'Zm00001eb220760', 'Zm00001eb159060', 'Zm00001eb309930', 'Zm00001eb361680', 'Zm00001eb266280', 'Zm00001eb287000', 'Zm00001eb242890', 'Zm00001eb314560', 'Zm00001eb010180', 'Zm00001eb355520', 'Zm00001eb320380', 'Zm00001eb438860', 'Zm00001eb326200',
              'Zm00001eb172210', 'Zm00001eb181580', 'Zm00001eb182890']
    organism="zmays"

    #get list of gene annotations
    res=functional_analysis(genList, organism)
    print(res)
    #plot the annotated vs unannotatied ratio
    genesToGo(len(genList), len(res))

if __name__ == "__main__":    
    main()