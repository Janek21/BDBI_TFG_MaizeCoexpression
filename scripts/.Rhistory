setwd("~/Desktop/Bioinformatics/3rd_year/Internship/HelmholtzZentrum_Munchen/Network_WGCNA/gitSent/scripts")
knitr::opts_chunk$set(echo = TRUE)
t<-read.table("../data/original_data/sample.tissue.correct.cluadj.txt")
t<-read.delim("../data/original_data/sample.tissue.correct.cluadj.txt")
View(t)
t<-read.delim("../data/original_data/sample.tissue.correct.cluadj.txt", header=FALSE, stringsAsFactors=TRUE)
View(t)
View(t)
View(t)
metadata<-read.delim("../data/original_data/sample.tissue.correct.cluadj.txt", header=FALSE, stringsAsFactors=TRUE, row.names=1)
colnames(metadata)<-c("specie", "quality", "tissue_abv", "rep", "tissue")
View(metadata)
library(ggplot2)
metadata<-read.delim("../data/original_data/sample.tissue.correct.cluadj.txt", header=FALSE, stringsAsFactors=TRUE, row.names=1)
colnames(metadata)<-c("specie", "quality", "tissue_abv", "rep", "tissue")
ggplot2(metadata, aes(x=quality))+
geom_bar()
levels(metadata$quality)
View(metadata)
ggplot2(metadata, aes(x=quality))+
geom_histogram()
ggplot(metadata, aes(x=quality))+
geom_histogram()
ggplot(metadata, aes(x=quality))+
geom_bar()
ggplot(metadata, aes(x=quality))+
geom_bar()+geom_wrap(species)
ggplot(metadata, aes(x=quality))+
geom_bar()+geom_wrap(specie)
ggplot(metadata, aes(x=quality))+
geom_bar()+grid_wrap(specie)
ggplot(metadata, aes(x=quality))+
geom_bar()+grid_wrap(~specie)
ggplot(metadata, aes(x=quality))+
geom_bar()+facet_wrap(specie)
ggplot(metadata, aes(x=quality))+
geom_bar()+facet_wrap(~specie)
ggplot(metadata, aes(x=quality))+
geom_bar()+facet_grid(~specie)
ggplot(metadata, aes(x=quality))+
geom_bar()+facet_grid(specie)
wrap
ggplot(metadata, aes(x=quality))+
geom_bar()+facet_wrap(~specie)
ggplot(metadata, aes(x=quality), color=tissue)+
geom_bar()+facet_wrap(~specie)
ggplot(metadata, aes(x=quality, color=tissue))+
geom_bar()+facet_wrap(~specie)
ggplot(metadata, aes(x=quality, color=specie))+
geom_bar()+facet_wrap(~tissue)
ggplot(metadata, aes(x=quality, color=tissue))+
geom_bar()+facet_wrap(~specie)
ggplot(metadata, aes(x=quality, fill=tissue))+
geom_bar()+facet_wrap(~specie)
ggplot(metadata, aes(x=quality, fill=tissue))+
geom_bar()
metaLQ<-metadata[metadata$quality!=0]
metaLQ<-metadata[metadata$quality!=0,]
View(metaLQ)
ggplot(metaLQ, aes(x=quality, fill=tissue))+
geom_bar()
ggplot(metaLQ, aes(x=quality, fill=tissue))+
geom_bar()+facet_wrap(~specie)
ggplot(metaLQ, aes(x=specie, fill=tissue))+
geom_bar()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar()+
scale_fill_brewer("Dark")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar()+
scale_fill_brewer("Dark2")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar()+
scale_fill_gradient("Dark2")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar()+
scale_fill_brewer(palette="Dark2")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=10)+
scale_fill_brewer(palette="Dark2")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=4)+
scale_fill_brewer(palette="Dark2")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=3)+
scale_fill_brewer(palette="Dark2")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=2)+
scale_fill_brewer(palette="Dark2")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
theme_bw()
theme_bw()
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
labels(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
labels(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
label(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
label(x="Line", y="Repetitions", fill="Tissue", color="Quality")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
labels(x="Line", y="Repetitions")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
labels(x="Line")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
xlab("line")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
labels(x="", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
labels(x="")
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
metaLQ$quality<-as.factor(metaLQ$quality)
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark")+
scale
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Set1")+
scale
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer()+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
scale_fill_color(palette)+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
scale_fill_color()+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
scale_fill_color()+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
scale_color_brewer()+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
scale_color_brewer(palette="Set1")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
scale_color_brewer()+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer()+
scale_color_brewer(palette="Setq")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer()+
scale_color_brewer(palette="Set1")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
scale_color_brewer(palette="Set1")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
scale_color_brewer(palette="Dark")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Dark2")+
scale_color_brewer(palette="Spectral")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer()+
scale_color_brewer(palette="Dark2")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer()+
scale_color_brewer(palette="Set1")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Spectral")+
scale_color_brewer(palette="Set1")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+
theme_bw()
ggplot(metadata, aes(x=quality, fill=tissue))+
geom_bar()
ggplot(metadata, aes(x=quality, fill=specie))+
geom_bar()
ggplot(metadata, aes(x=quality, fill=specie))+
geom_bar()+
scale_fill_brewer(palette="Dark2")
ggplot(metadata, aes(x=quality, fill=specie))+
geom_bar()+
scale_fill_brewer(palette="Dark2")+
theme_bw()
ggplot(metadata, aes(x=quality, fill=specie))+
geom_bar()+
scale_fill_brewer(palette="Dark2")+
labs(x="Line", y="Repetitions", fill="Species")
theme_bw()
ggplot(metadata, aes(x=quality, fill=specie))+
geom_bar()+
scale_fill_brewer(palette="Dark2")+
labs(x="Line", y="Repetitions", fill="Species")+
theme_bw()
ggplot(metadata, aes(x=quality, fill=specie))+
geom_bar()+
scale_fill_brewer(palette="Dark2")+
labs(x="Line", y="Repetitions", fill="Species", title="Quality count")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Spectral")+
scale_color_brewer(palette="Set1")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality", title="Low quality per tissue and line")+
theme_bw()
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Spectral")+
scale_color_brewer(palette="Set1")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+#, title="Low quality per tissue and line")+
theme_bw()
nrow(data)
data<-read.delim("../data/original_data/all5gt.nolen.csv", header=FALSE, stringsAsFactors=TRUE, row.names=1)
metadata<-read.delim("../data/original_data/sample.tissue.correct.cluadj.txt", header=FALSE, stringsAsFactors=TRUE, row.names=1)
colnames(metadata)<-c("specie", "quality", "tissue_abv", "rep", "tissue")
nrow(data)
nrow(metadata)
metadata<-metadata[metadata$quality==0]
metadata<-metadata[,metadata$quality==0]
metadata<-metadata[metadata$quality==0,]
View(data)
data<-read.delim("../data/original_data/all5gt.nolen.csv", stringsAsFactors=TRUE, row.names=1)
View(data)
data<-data[colname(data) %in% rownames(metadata)]
data[colname(data) %in% rownames(metadata)]
colnames(data) %in% rownames(metadata)
data<-data[colnames(data) %in% rownames(metadata)]
nrow(data)
ncol(data)
nrow(metadata)
rd<-rownames(metadata)
colnames(data)!=rd
tf<-colnames(data) %in% rownames(metadata)
yy<-!tf
yy
rd[yy]
as.vector(rd)[yy]
as.data.frame(rd)[yy]
yy
tf<-rownames(metadata) %in% colnames(data)
yy<-!tf
as.data.frame(rd)[yy]
rd[yy]
metadata[yy]
metadata[yy,]
metadata[!rownames(metadata) %in% colnames(data),]
metadata[!rownames(metadata) %in% colnames(data),]
metadata[metadata$tissue=="pollen"]
metadata[metadata$tissue=="pollen",]
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
data<-read.delim("../data/original_data/all5gt.nolen.csv", stringsAsFactors=TRUE, row.names=1)
metadata<-read.delim("../data/original_data/sample.tissue.correct.cluadj.txt", header=FALSE, stringsAsFactors=TRUE, row.names=1)
colnames(metadata)<-c("specie", "quality", "tissue_abv", "rep", "tissue")
ggplot(metadata, aes(x=quality, fill=specie))+
geom_bar()+
scale_fill_brewer(palette="Dark2")+
labs(x="Line", y="Repetitions", fill="Species")+#, title="Quality count")+
theme_bw()
metaLQ<-metadata[metadata$quality!=0,]
metaLQ$quality<-as.factor(metaLQ$quality)
ggplot(metaLQ, aes(x=specie, fill=tissue, color=quality))+
geom_bar(size=1)+
scale_fill_brewer(palette="Spectral")+
scale_color_brewer(palette="Set1")+
labs(x="Line", y="Repetitions", fill="Tissue", color="Quality")+#, title="Low quality per tissue and line")+
theme_bw()
#For metadata
metadata<-metadata[metadata$quality==0,]
#For data
data<-data[colnames(data) %in% rownames(metadata)]
ncol(data)
nrow(metadata)
metadata[!rownames(metadata) %in% colnames(data),]
#Pollen samples, are those all the pollen samples?
metadata[metadata$tissue=="pollen",]
